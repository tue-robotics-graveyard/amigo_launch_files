<?xml version="1.0"?>

<launch>

    <!-- base laser - real -->    
    <group unless="$(optenv ROBOT_SIM true)">
        <!--include file="$(find amigo_laser)/start.launch" /--> <!-- real (autostart.launch) -->
        <include file="$(find amigo_machine_files)/machines/amigo1.machine" />

        <node pkg="hokuyo_node" type="hokuyo_node" name="hokuyo_node" output="screen" machine="amigo1">
            <remap from="scan" to="/base_scan"/>
            <param name="frame_id" value="/base_laser"/>
        </node>


        <node name="$(anon dynparam)" pkg="dynamic_reconfigure" type="dynparam" args="set_from_parameters hokuyo_node">
            <param name="min_ang" type="double" value="-2.1" />
            <param name="max_ang" type="double" value="2.1" />
        </node>
    </group>
    
    <!-- base laser - simulation -->        
    <group if="$(optenv ROBOT_SIM true)">
        <!--include file="$(find amigo_laser_filter)/start_base_filter.launch" /--> <!-- simulation (start_base_navigation.launch -->
        <!-- convert base laser scan to pointcloud -->
        <node pkg="laser_filters" type="scan_to_cloud_filter_chain" output="screen" name="scan_to_cloud_filter_chain_tilt_laser">
            <remap from="scan" to="base_scan"/>
            <remap from="cloud_filtered" to="base_scan_cloud"/>
            <param name="target_frame" type="string" value="/base_link"/>
            <rosparam command="load" file="$(find amigo_laser_filter)/parameters/shadow_filter.yaml" />            
        </node>
    </group>
    
    

</launch>
  
